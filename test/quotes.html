<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Smooth Quote Scroll</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #111;
  }

  #quoteWrapper {
    position: relative;
    width: 100vw;
    height: 30px;
    background: #1d201f;
    overflow: hidden;
    display: flex;
    align-items: center;
  }

  #quoteBox {
    position: absolute;
    white-space: nowrap;
    font-size: 20px;
    color: white;
    transform: translateX(100%);
  }
</style>
</head>
<body>
  <div id="quoteWrapper">
    <div id="quoteBox">Loading...</div>
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const wrapper = document.getElementById("quoteWrapper");
  const box = document.getElementById("quoteBox");
  const jsonPath = "../system/json/quotes.json"; // your JSON file

  let quotes = [];
  let pos = 0;
  let speed = 120; // px/sec
  let lastTime = null;

  // Speed scaling factors
  const baseSpeed = 120;
  const slowSpeed = baseSpeed * 0.5;
  const slowerSpeed = baseSpeed * 0.25;

  let isHoveringWrapper = false;
  let isHoveringText = false;
  let isMouseDown = false;

  async function loadQuotes() {
    try {
      const res = await fetch(jsonPath);
      const data = await res.json();
      quotes = Array.isArray(data) && data.length ? data : ["No quotes found"];
      start();
    } catch {
      quotes = ["âš  Error loading quotes"];
      start();
    }
  }

  function setQuote() {
    const quote = quotes[Math.floor(Math.random() * quotes.length)];
    box.textContent = quote;
    // start just offscreen right
    pos = wrapper.offsetWidth;
  }

  function updateSpeed() {
    if (isMouseDown) speed = 0;
    else if (isHoveringText) speed = slowerSpeed;
    else if (isHoveringWrapper) speed = slowSpeed;
    else speed = baseSpeed;
  }

  function animate(time) {
    if (lastTime !== null) {
      const dt = (time - lastTime) / 1000;
      pos -= speed * dt;
      box.style.transform = `translateX(${pos}px)`;

      // reset when fully off left
      if (pos + box.offsetWidth < 0) {
        setQuote();
      }
    }
    lastTime = time;
    requestAnimationFrame(animate);
  }

  function start() {
    setQuote();
    requestAnimationFrame(animate);
  }

  // Event listeners
  wrapper.addEventListener("mouseenter", () => {
    isHoveringWrapper = true;
    updateSpeed();
  });
  wrapper.addEventListener("mouseleave", () => {
    isHoveringWrapper = false;
    isHoveringText = false;
    updateSpeed();
  });
  box.addEventListener("mouseenter", () => {
    isHoveringText = true;
    updateSpeed();
  });
  box.addEventListener("mouseleave", () => {
    isHoveringText = false;
    updateSpeed();
  });
  wrapper.addEventListener("mousedown", () => {
    isMouseDown = true;
    updateSpeed();
  });
  wrapper.addEventListener("mouseup", () => {
    isMouseDown = false;
    updateSpeed();
  });

  loadQuotes();
});
</script>
</body>
</html>
