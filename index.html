<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WannaSmile | Home</title>
  <link rel="icon" href="https://raw.githubusercontent.com/wanna5mile/wanna5mile.github.io/main/system/images/favicons/logo.png" />
  <meta name="author" content="WannaSmile by Rhap5ody" />
  <meta name="keywords" content="github, repository, source, library" />

  <!-- Styles -->
  <link rel="stylesheet" href="system/css/themes.css" />
  <link rel="stylesheet" href="system/css/main.css" />
  <link rel="stylesheet" href="system/css/loading-screen.css" />
  <link rel="stylesheet" href="system/css/commands.css" />

  <!-- Discord Widget -->
  <script async defer src="https://cdn.jsdelivr.net/npm/@widgetbot/crate@3"></script>
  <script>
    window.addEventListener("load", () => {
      if (typeof Crate !== "undefined") {
        new Crate({
          server: '1273329263923302430',
          channel: '1329289920845713471'
        });
      }
    });
  </script>

  <!-- Social Meta -->
  <meta property="og:title" content="WannaSmile" />
  <meta property="og:description" content="Welcome to WannaSmile — a library full of content! Enjoy it in your free time." />
  <meta property="og:image" content="https://www.yourwebsite.com/path/to/your/preview-image.jpg" />
  <meta property="og:url" content="https://vvannasmile.github.io/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="WannaSmile.github.io" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="WannaSmile" />
  <meta name="twitter:description" content="A fun, content-filled library to make you smile." />
  <meta name="twitter:image" content="https://www.yourwebsite.com/path/to/your/preview-image.jpg" />
</head>
<body>
  <!-- Preloader -->
<div id="preloader" class="preloader">
  <div class="loader-gif">
    
    <!-- Loading GIF (default visible) -->
    <img id="loaderImage" src="https://raw.githubusercontent.com/wanna5mile/wanna5mile.github.io/main/system/images/GIF/loading.gif" alt="Loading animation" />

    <!-- Loaded GIF (starts hidden, fades in when ready) -->
    <img id="loadedImage" src="https://raw.githubusercontent.com/wanna5mile/wanna5mile.github.io/main/system/images/GIF/loaded.gif" alt="Loaded animation" style="opacity:0;" />
  </div>

  <div class="load-progress-bar">
    <div id="progressBar" class="load-progress-fill"></div>
  </div>

  <div id="loaderText" class="loading-text">Loading...</div>
</div>

  <div id="topBar">
    <header>
      <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="favorites.html">Favorites</a>
        <a href="system/pages/discovery.html">Discovery</a>
        <a href="system/pages/settings.html">Settings</a>
        <a href="system/pages/support.html">Support</a>
        <a href="info.html">Info</a>
        <div class="pages-anchor">
          <button class="arrowleft" onclick="prevPage()"><img src="https://raw.githubusercontent.com/wanna5mile/wanna5mile.github.io/main/system/icons/left.png" /></button>
          <span class="page-indicator">...</span>
          <button class="arrowright" onclick="nextPage()"><img src="https://raw.githubusercontent.com/wanna5mile/wanna5mile.github.io/main/system/icons/right.png" /></button>
        </div>
      </nav>

      <div class="header-controls">
        <div class="search-box">
          <input id="searchInputHeader" type="text" placeholder="Search ϱames..." />
          <button id="searchBtnHeader"><img src="https://raw.githubusercontent.com/wanna5mile/wanna5mile.github.io/main/system/icons/search.png" /></button>
        </div>
        <a href="system/pages/profile.html"><img id="pfp" src="https://raw.githubusercontent.com/wanna5mile/wanna5mile.github.io/main/system/icons/profile.png" /></a>
        <button id="dashboardBtn"><img src="system/icons/dashboard.png" /></button>
      </div>
    </header>

    <div id="quoteWrapper">
      <p id="quoteBox">Loading...</p>
    </div>
  </div>

  <aside id="dashboardMenu" class="dashboard-menu">
    <p>pages</p>
    <a href="https://bguhm.github.io/music-player.html">Music Player</a>
    <a href="system/pages/settings-themes.html">Themes</a>
    <a href="system/pages/credits.html">Credits</a>

    <p>dev tools</p>
    <a href="system/pages/devtools/rawfetch.html">raw image link fetcher</a>
    <a href="system/pages/devtools/textflip.html">text flip/mirror</a>

    <p>other</p>
    <a href="system/pages/alt.html">Alternative Links</a>
  </aside>

  <main>
    <div id="container">Loading assets...</div>
  </main>

  <button id="toTopBtn">⬆ Top</button>

  <footer>
    <a href="system/pages/sources.html">Sources</a>
    <a href="system/pages/contributors.html">Contribute</a>
    <a href="system/pages/discord.html">Discord</a>
    <a href="system/pages/bugsNfixes.html">Bugs & Fixes</a>
    <a href="system/pages/contact.html">Socials</a>
    <a href="system/archive/index.html">archived versions</a>
    <a href="system/pages/update-logs.html" id="footerVersion">Version loading...</a>
  </footer>

  <!-- JS -->
  <script src="system/js/settings.js" defer></script>
  <script src="system/js/commands.js" defer></script>
  <script src="system/js/main.js" defer></script>
  <script src="system/js/searcherror.js" defer></script>
  <script src="system/js/index.js" defer></script>
  <script src="system/js/version.js" defer></script>
  <script src="system/js/all.js" defer></script>

  <!-- Quotes Scroll -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const wrapper = document.getElementById("quoteWrapper");
      const box = document.getElementById("quoteBox");
      const jsonPath = "../system/json/quotes.json";

      let quotes = [];
      let pos = 0;
      let lastTime = null;

      const baseSpeed = 120;
      const slowSpeed = 70;
      const slowerSpeed = 30;

      let currentSpeed = baseSpeed;
      let isHoveringBox = false;
      let isHoveringText = false;
      let isMouseDown = false;

      async function loadQuotes() {
        try {
          const res = await fetch(jsonPath);
          const data = await res.json();
          quotes = Array.isArray(data) && data.length ? data : ["No quotes found"];
          start();
        } catch {
          quotes = ["⚠ Error loading quotes"];
          start();
        }
      }

      function setQuote() {
        const quote = quotes[Math.floor(Math.random() * quotes.length)];
        box.textContent = quote;
        pos = wrapper.offsetWidth;
        box.style.transform = `translateX(${pos}px)`;
      }

      function updateSpeed() {
        if (isMouseDown) currentSpeed = 0;
        else if (isHoveringText) currentSpeed = slowerSpeed;
        else if (isHoveringBox) currentSpeed = slowSpeed;
        else currentSpeed = baseSpeed;
      }

      function animate(time) {
        if (lastTime !== null) {
          const dt = (time - lastTime) / 1000;
          pos -= currentSpeed * dt;
          box.style.transform = `translateX(${pos}px)`;
          if (pos + box.offsetWidth < 0) setQuote();
        }
        lastTime = time;
        requestAnimationFrame(animate);
      }

      function start() {
        setQuote();
        requestAnimationFrame(animate);
      }

      wrapper.addEventListener("mouseenter", () => { isHoveringBox = true; updateSpeed(); });
      wrapper.addEventListener("mouseleave", () => { isHoveringBox = false; isHoveringText = false; updateSpeed(); });
      box.addEventListener("mouseenter", () => { isHoveringText = true; updateSpeed(); });
      box.addEventListener("mouseleave", () => { isHoveringText = false; updateSpeed(); });
      wrapper.addEventListener("mousedown", () => { isMouseDown = true; updateSpeed(); });
      wrapper.addEventListener("mouseup", () => { isMouseDown = false; updateSpeed(); });

      loadQuotes();
    });
  </script>

  <!-- PFP Loader -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const pfp = document.getElementById("pfp");
      const defaultPic = "system/icons/profile.png";

      const currentUser = localStorage.getItem("currentUser");
      if (!currentUser) {
        pfp.src = defaultPic;
        return;
      }

      const userData = JSON.parse(localStorage.getItem("user_" + currentUser) || "{}");
      const profileData = JSON.parse(localStorage.getItem("profile_" + currentUser) || "{}");

      const userPic = profileData.pic || defaultPic;

      pfp.src = userPic;

      const cachedPreview = {
        username: userData.username || profileData.nickname || currentUser,
        pic: userPic
      };
      localStorage.setItem("preview_" + currentUser, JSON.stringify(cachedPreview));
    });
  </script>

  <!-- To Top Button -->
  <script defer>
    const toTopBtn = document.getElementById("toTopBtn");

    window.addEventListener("scroll", () => {
      const scrollY = window.scrollY;
      if (scrollY > 250) {
        toTopBtn.classList.add("show");
      } else {
        toTopBtn.classList.remove("show");
      }
    });

    toTopBtn.addEventListener("click", () => {
      window.scrollTo({
        top: 0,
        behavior: "smooth"
      });
    });
  </script>
  <script src="https://cdn.jsdelivr.net/gh/wanna5mile/wanna5mile.github.io@main/system/js/top.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/wanna5mile/wanna5mile.github.io@main/system/js/pages.js" defer></script>
<script>
js:(function () {

  // ================================
  // PROJECT URL PATTERNS
  // ================================
  const patterns = [
    "https://wanna5mile.github.io./source/",
    "https://bguhm.github.io./library/",
    "https://wanna5mile.github.io./source-expanded/"
  ];

  function matchesProject(url) {
    return patterns.some(p => url.startsWith(p));
  }

  // ================================
  // ABOUT:BLANK WRAPPER
  // ================================
  function openProject(url) {
    const win = window.open("about:blank");
    if (!win) return;

    const fakeLayers = [
      { title: "Sheets",          icon: "icons/sheets.png",     image: "sheets_hi.png" },
      { title: "No Internet",     icon: "icons/warning.png",    image: "nofi_hi.png" },
      { title: "Document Viewer", icon: "icons/document.png",   image: "document_hi.png" },
      { title: "My Files",        icon: "icons/files.png",      image: "myfiles_hi.png" },
      { title: "Dashboard",       icon: "icons/dashboard.png",  image: "dashboard_hi.png" }
    ];

    const originalTitle = "Loading…";
    const originalIcon = "";

    win.document.open();
    win.document.write(`
<!DOCTYPE html>
<html>
<head>
  <title>${originalTitle}</title>
  <link id="appFavicon" rel="icon" href="${originalIcon}">
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    /* Fullscreen embed */
    #realApp {
      position: absolute;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      border: none;
    }

    /* Fullscreen fake cover */
    #fakeCover {
      position: absolute;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      display: none;
      background: #fff;
      z-index: 9999999;
    }

    #fakeCover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  </style>
</head>

<body>

  <!-- REAL GAME -->
  <embed id="realApp" src="${url}">

  <!-- FAKE COVER (hidden until tab inactive) -->
  <div id="fakeCover">
    <img id="fakeImage">
  </div>

  <script>
    const fakeLayers = ${JSON.stringify(fakeLayers)};
    const cover = document.getElementById("fakeCover");
    const coverImg = document.getElementById("fakeImage");
    const favicon = document.getElementById("appFavicon");

    const originalTitle = document.title;
    const originalIcon = favicon.href;

    // Show fake cover + tab cloak ONLY when the tab is unfocused
    function applyFakeLayer() {
      const pick = fakeLayers[Math.floor(Math.random() * fakeLayers.length)];
      coverImg.src = pick.image;
      document.title = pick.title;
      favicon.href = pick.icon;
      cover.style.display = "block";
    }

    // Remove fake cover + restore original
    function removeFakeLayer() {
      cover.style.display = "none";
      document.title = originalTitle;
      favicon.href = originalIcon;
    }

    // Blur → cloak on
    window.addEventListener("blur", applyFakeLayer);

    // Focus → cloak off
    window.addEventListener("focus", removeFakeLayer);

    // Remove cover immediately on load
    removeFakeLayer();
  <\/script>

</body>
</html>
    `);

    win.document.close();
  }

  // ================================
  // CLICK INTERCEPT
  // ================================
  document.addEventListener("click", (e) => {
    const a = e.target.closest("a");
    if (!a || !a.href) return;

    const url = a.href;

    if (matchesProject(url)) {
      e.preventDefault();
      openProject(url);
    }
  });

  // ================================
  // window.open INTERCEPT
  // ================================
  const originalOpen = window.open;
  window.open = function (url, ...rest) {
    if (typeof url === "string" && matchesProject(url)) {
      openProject(url);
      return null;
    }
    return originalOpen.call(window, url, ...rest);
  };

})();
</script>
</body>
</html>
